!function(){"use strict";var e,t,n,r,a,c={6885:function(e,t,n){var r=n(2791),a=n(1250),c=function(e){e&&e instanceof Function&&n.e(787).then(n.bind(n,787)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))},i=n(4687),u=n.n(i);var o=n(184),s=function(e){return(0,o.jsx)("iframe",{title:"advertisement",src:e.url,onLoad:e.onLoad,style:{overflow:"hidden",height:"100vh",width:"100%",broder:"none"}})},l=n(4569),f=n.n(l)().create({headers:{"Content-Type":"application/json"}});f.interceptors.request.use((function(e){return e}));var d=f,p=n(5861),v=function(){var e=(0,p.Z)(u().mark((function e(t,n,r,a){var c,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="".concat("https://api.street-smart.co:10443","/v1/api/hive/content/?slug=").concat(n,"&screenid=").concat(t,"&remain_duration=").concat(r,"&id=").concat(a),e.next=3,d.get(c);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),h=function(){var e=(0,p.Z)(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.get("".concat("https://api.street-smart.co:10443","/v1/api/programmaticads/").concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=(0,p.Z)(u().mark((function e(t,n,r){var a,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,a="".concat("https://api-report.street-smart.co:10443","/v1/api/hive/trackingstart/?ss_uuid=").concat(t,"&supplier=").concat(n,"&slug=").concat(r),e.next=5,d.get(a);case 5:return c=e.sent,e.abrupt("return",c);case 9:e.prev=9,e.t0=e.catch(1);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n,r){return e.apply(this,arguments)}}(),m=function(){var e=(0,p.Z)(u().mark((function e(t,n,r,a){var c,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,c="".concat("https://api-report.street-smart.co:10443","/v1/api/hive/trackingsuccess/?ss_uuid=").concat(t,"&supplier=").concat(n,"&slug=").concat(r,"&type=").concat(a),e.next=5,d.get(c);case 5:return i=e.sent,e.abrupt("return",i);case 9:e.prev=9,e.t0=e.catch(1);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),g=function(){var e=(0,p.Z)(u().mark((function e(t,n,r,a){var c,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,c="".concat("https://api-report.street-smart.co:10443","/v1/api/hive/trackingstop/?ss_uuid=").concat(t,"&supplier=").concat(n,"&slug=").concat(r,"&type=").concat(a),e.next=5,d.get(c);case 5:return i=e.sent,e.abrupt("return",i);case 9:e.prev=9,e.t0=e.catch(1);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),x=n(4245),w=function(){var e,t,n;try{"string"==typeof(n=window.client.getClientInfo())&&(n=JSON.parse(n))}catch(e){}return"73A40551"===(null===(e=n)||void 0===e?void 0:e.sn)?"Test_Office_Screen_1":"".concat(null===(t=n)||void 0===t?void 0:t.sn,"F")},k=n(885),y=function(e){var t=(0,r.useState)(!0),n=(0,k.Z)(t,2),a=n[0],c=n[1],i=(0,r.useState)("/assets/SS_Media_Full_Screen.jpg"),o=(0,k.Z)(i,2),s=o[0],l=o[1],f=(0,r.useState)(null),d=(0,k.Z)(f,2),v=d[0],b=d[1],m=(0,r.useState)(120),g=(0,k.Z)(m,2),x=g[0],w=g[1],y=function(){var t=(0,p.Z)(u().mark((function t(){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c(!0),t.prev=1,t.next=4,h(e);case 4:(n=t.sent).status>=200&&n.status<400&&((r=n.data.data[0]).initial_image&&l(r.initial_image),w(r.duration),c(!1),b(r.id)),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),c(!1);case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(){return t.apply(this,arguments)}}();return(0,r.useEffect)((function(){y()}),[]),{isLoading:a,campaignId:v,initialImageUrl:s,duration:x}},j=((new Date).getTime(),window.location.search),O=x.parse(j),T=(null==O||O.token,w(),n(3395)),_=n(3144),S=n(5671),L=(0,_.Z)((function e(t,n,r,a,c,i,u,o,s,l){(0,S.Z)(this,e),this.adsUrl=t,this.adsType=n,this.duration=r,this.nextReqTime=r-5e3,this.timeStamp=a,this.trackSuccessUrl=c,this.trackFailUrl=i,this.blob=u,this.loop=o||!1,this.supplierId=s,this.hive_creativeid=l})),Z=n(3137),U=new(n.n(Z)()),R=null,E="video_cache",F=null,P=function(e,t){if(R){var n=R.transaction(E,"readwrite").objectStore(E).add({vid:e,blob:t});n.addEventListener("success",(function(){})),n.addEventListener("error",(function(){}))}},C=function(e){return new Promise((function(t,n){if(R){var r=R.transaction(E).objectStore(E).get(e);r.addEventListener("success",(function(){r.result?t(r.result.blob):t(null)})),r.addEventListener("error",(function(){t(null)}))}else t(null)}))},I="0",A=function(e,t,n,a,c,i){var o=(0,r.useState)(!0),s=(0,k.Z)(o,2),l=s[0],f=s[1],h=(0,r.useState)(null),x=(0,k.Z)(h,2),w=x[0],y=x[1],j=(0,r.useState)(null),O=(0,k.Z)(j,2),T=O[0],_=O[1],S=(0,r.useState)(null),Z=(0,k.Z)(S,2),R=Z[0],E=Z[1];(0,r.useEffect)((function(){var r=function(){var r=(0,p.Z)(u().mark((function r(){var s,l,d,p,h,m,g,x,w,k,j,O,S;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=1,b(t,void 0,n),r.next=5,v(t,n,a,c);case 5:if(!((s=r.sent).status>=200&&s.status<400)){r.next=66;break}if(!(l=s.data)||0!==Object.keys(l).length||Object.getPrototypeOf(l)!==Object.prototype){r.next=14;break}r.next=64;break;case 14:if(d=1e3*l.duration+Math.floor(180*Math.random()),p=l.text,h=l.type,m=l.time_stamp,g=l.supplier_id,x=l.impression,w=l.error,y(0),k=l.hive_creativeid,!h){r.next=63;break}if(!h.includes("html")){r.next=35;break}return r.next=32,A(x,g,n,h);case 32:j=new L(p,h,d,m,x,w,null,!1,g,k),r.next=60;break;case 35:if(!h.includes("image")){r.next=41;break}return r.next=38,A(x,g,n,h);case 38:j=new L(p,h,d,m,x,w,null,!1,g,k),r.next=60;break;case 41:return O=p.startsWith("https://tms-backend.s3.ap-southeast-1.amazonaws.com"),r.next=45,C(k);case 45:if(S=r.sent){r.next=57;break}return r.next=49,i(p,h);case 49:if(S=r.sent){r.next=56;break}return r.next=54,F(w,g,n,h);case 54:return N(),r.abrupt("return");case 56:P(k,S);case 57:return r.next=59,A(x,g,n,h);case 59:j=new L(p,h,d,m,x,w,S,O,g,k);case 60:0===e||null===T?(f(!1),_(j)):o(j),r.next=64;break;case 63:case 64:r.next=69;break;case 66:f(!0);case 69:r.next=75;break;case 71:r.prev=71,r.t0=r.catch(1),f(!0);case 75:case"end":return r.stop()}}),r,null,[[1,71]])})));return function(){return r.apply(this,arguments)}}(),i=function(){var e=(0,p.Z)(u().mark((function e(t,n){var r,a,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={responseType:"blob"},e.next=7,d.get(t,r);case 7:return a=e.sent,c=null,a.status>=200&&a.status<400&&(c=new Blob([a.data])),e.abrupt("return",c);case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}(),o=function(e){U.del(I),U.set(I,e,9e4)};n&&c&&r()}),[e,t,n,c]);var F=function(){var e=(0,p.Z)(u().mark((function e(n,r,a,c){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,fetch(n);case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),E(e.t0);case 10:return e.prev=10,e.next=13,g(t,r,a,c);case 13:e.next=18;break;case 15:e.prev=15,e.t1=e.catch(10);case 18:case"end":return e.stop()}}),e,null,[[1,6],[10,15]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),A=function(){var e=(0,p.Z)(u().mark((function e(n,r,a,c){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,fetch(n);case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),E(e.t0);case 10:return e.prev=10,e.next=13,m(t,r,a,c);case 13:e.next=18;break;case 15:e.prev=15,e.t1=e.catch(10);case 18:case"end":return e.stop()}}),e,null,[[1,6],[10,15]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),N=function(){y(w+1)};return{isLoading:l,currentAds:T,failCount:w,pullNextAds:function(){var e=U.get(I);T&&e?(_(e),U.del(I)):(N(),_(null),f(!0))},createObjectURL:function(e){return window.URL?window.URL.createObjectURL(e):window.webkitURL.createObjectURL(e)},revokeObjectURL:function(e){return window.URL?window.URL.revokeObjectURL(e):window.webkitURL.revokeObjectURL(e)},trackingSuccess:A,trackingFail:F,updateFailCount:N,skipAds:function(){!function(e){for(var t=(new Date).getTime()+1e3*e;(new Date).getTime()<=t;);}(2)},error:R}},N=window.location.search,M=x.parse(N),q=(null==M?void 0:M.token)||void 0,D=w(),B=(new Date).getTime(),z=function(){var e,t,n,a,c,i=(0,r.useState)(!1),u=(0,k.Z)(i,2),l=u[0],f=u[1],d=(0,r.useState)(0),p=(0,k.Z)(d,2),v=p[0],h=p[1],b=(0,r.useState)(0),m=(0,k.Z)(b,2),g=m[0],x=m[1],w=y(q),j=(w.cIsLoading,w.campaignId),O=w.initialImageUrl,_=w.duration-Math.ceil(((new Date).getTime()-B)/1e3),S=A(v,D,q,_,j,l),L=S.isLoading,Z=S.currentAds,U=S.failCount,R=S.pullNextAds,E=S.createObjectURL,F=S.revokeObjectURL,P=(S.trackingSuccess,S.trackingFail),C=S.updateFailCount,I=S.skipAds,N=(S.error,(0,r.useState)(null)),M=(0,k.Z)(N,2),z=M[0],J=M[1],W=(0,r.useRef)(),G=(0,r.useRef)();return l&&_<10&&I(),(0,r.useEffect)((function(){if(Z&&Z.adsType&&Z.adsType.includes("video")&&W.current)if(Z.blob){var e=E(Z.blob);J(e),W.current.src=e}else C();f(null!=Z&&null!=Z.adsType)}),[Z]),(0,r.useEffect)((function(){if(Z&&(Z.nextReqTime||0!==Z.nextReqTime)){var e=setTimeout((function(){h(v+1)}),null==Z?void 0:Z.nextReqTime);return function(){clearTimeout(e)}}}),[Z]),(0,r.useEffect)((function(){if(Z&&(Z.duration||0!==Z.duration)){var e=setTimeout((function(){R()}),null==Z?void 0:Z.duration);return function(){clearTimeout(e)}}l&&I()}),[Z]),(0,r.useEffect)((function(){var e=setTimeout((function(){U>0&&h(v+1)}),2e3);return function(){clearTimeout(e)}}),[U]),(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(T.ZP,{container:!0,children:[O?(0,o.jsx)("img",{src:O,style:{display:!1===L?"none":"block",zIndex:100,position:"fixed"},width:"100%",height:"100%"}):(0,o.jsx)(o.Fragment,{}),Z&&null!==(e=Z.adsType)&&void 0!==e&&e.includes("image")?(0,o.jsx)("img",{ref:G,src:Z.adsUrl,style:{display:null!==(t=Z.adsType)&&void 0!==t&&t.includes("image")?"block":"none",zIndex:102,position:"fixed"},width:"100%",height:"100%"}):(0,o.jsx)(o.Fragment,{}),Z&&null!==(n=Z.adsType)&&void 0!==n&&n.includes("html")?(0,o.jsx)(s,{style:{display:null!==(a=Z.adsType)&&void 0!==a&&a.includes("html")?"block":"none"},url:Z.adsUrl,onLoad:function(){}}):(0,o.jsx)(o.Fragment,{}),(0,o.jsx)("div",{className:"video_wrap",style:{display:Z&&null!==(c=Z.adsType)&&void 0!==c&&c.includes("video")?"block":"none"},children:(0,o.jsx)("video",{className:"blob_video",ref:W,autoPlay:!0,poster:"null",muted:!0,loop:(null==Z?void 0:Z.loop)||!1,onPlay:function(e){},onPlaying:function(e){},onEnded:function(e){},onError:function(e){var t;null!=Z&&null!==(t=Z.adsType)&&void 0!==t&&t.includes("video")&&e.target.error&&(P(Z.trackFailUrl,Z.supplier,Z.adsType),F(z),J(null),h(0),x(g+1))}})})]})})};(F=window.indexedDB.open("ss_video_cache",1)).onerror=function(e){},F.onsuccess=function(e){R=e.target.result},F.onupgradeneeded=function(e){(R=e.target.result).objectStoreNames.contains(E)||R.createObjectStore(E,{keyPath:"vid"}).createIndex("blob","blob",{unique:!1})},a.createRoot(document.getElementById("root")).render((0,o.jsx)(z,{})),c()}},i={};function u(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return c[e].call(n.exports,n,n.exports,u),n.exports}u.m=c,e=[],u.O=function(t,n,r,a){if(!n){var c=1/0;for(l=0;l<e.length;l++){n=e[l][0],r=e[l][1],a=e[l][2];for(var i=!0,o=0;o<n.length;o++)(!1&a||c>=a)&&Object.keys(u.O).every((function(e){return u.O[e](n[o])}))?n.splice(o--,1):(i=!1,a<c&&(c=a));if(i){e.splice(l--,1);var s=r();void 0!==s&&(t=s)}}return t}a=a||0;for(var l=e.length;l>0&&e[l-1][2]>a;l--)e[l]=e[l-1];e[l]=[n,r,a]},u.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return u.d(t,{a:t}),t},n=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__},u.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var a=Object.create(null);u.r(a);var c={};t=t||[null,n({}),n([]),n(n)];for(var i=2&r&&e;"object"==typeof i&&!~t.indexOf(i);i=n(i))Object.getOwnPropertyNames(i).forEach((function(t){c[t]=function(){return e[t]}}));return c.default=function(){return e},u.d(a,c),a},u.d=function(e,t){for(var n in t)u.o(t,n)&&!u.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},u.f={},u.e=function(e){return Promise.all(Object.keys(u.f).reduce((function(t,n){return u.f[n](e,t),t}),[]))},u.u=function(e){return"static/js/"+(461===e?"webfontloader":e)+"."+{461:"65c0ceb5",787:"080222f6"}[e]+".chunk.js"},u.miniCssF=function(e){},u.miniCssF=function(e){},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r={},a="react_base:",u.l=function(e,t,n,c){if(r[e])r[e].push(t);else{var i,o;if(void 0!==n)for(var s=document.getElementsByTagName("script"),l=0;l<s.length;l++){var f=s[l];if(f.getAttribute("src")==e||f.getAttribute("data-webpack")==a+n){i=f;break}}i||(o=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,u.nc&&i.setAttribute("nonce",u.nc),i.setAttribute("data-webpack",a+n),i.src=e),r[e]=[t];var d=function(t,n){i.onerror=i.onload=null,clearTimeout(p);var a=r[e];if(delete r[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach((function(e){return e(n)})),t)return t(n)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=d.bind(null,i.onerror),i.onload=d.bind(null,i.onload),o&&document.head.appendChild(i)}},u.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.p="/",function(){var e={179:0};u.f.j=function(t,n){var r=u.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var a=new Promise((function(n,a){r=e[t]=[n,a]}));n.push(r[2]=a);var c=u.p+u.u(t),i=new Error;u.l(c,(function(n){if(u.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=n&&("load"===n.type?"missing":n.type),c=n&&n.target&&n.target.src;i.message="Loading chunk "+t+" failed.\n("+a+": "+c+")",i.name="ChunkLoadError",i.type=a,i.request=c,r[1](i)}}),"chunk-"+t,t)}},u.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,a,c=n[0],i=n[1],o=n[2],s=0;if(c.some((function(t){return 0!==e[t]}))){for(r in i)u.o(i,r)&&(u.m[r]=i[r]);if(o)var l=o(u)}for(t&&t(n);s<c.length;s++)a=c[s],u.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return u.O(l)},n=self.webpackChunkreact_base=self.webpackChunkreact_base||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var o=u.O(void 0,[293,109],(function(){return u(6885)}));o=u.O(o)}();
//# sourceMappingURL=main.507bce99.js.map